---
applyTo: "docs/changes/**/*.md"
description: "專案變更日誌文件生成規範"
---

# 變更日誌文件生成指令

供 AI 代理在專案變更時自動產生變更日誌文件的規範與格式。

---

## 指令

當進行重構、新增功能或重大變更時，應在 `docs/changes/` 目錄中建立對應的變更日誌文件。

---

## 目標

- 記錄所有重要的專案變更
- 提供清晰的變更說明和技術細節
- 便於團隊成員理解變更內容和影響
- 建立可追蹤的變更歷史

---

## 檔案命名規範

```
docs/changes/{變更類型}-{功能名稱}-{變更說明}.md
```

### 變更類型分類

- `refactor` - 重構相關變更
- `feature` - 新功能實作
- `fix` - 錯誤修復
- `update` - 功能更新
- `security` - 安全性改進
- `performance` - 效能最佳化
- `config` - 配置變更
- `database` - 資料庫相關變更

### 命名範例

- `refactor-email-verification-api-web-separation.md`
- `feature-password-reset-web-interface.md`
- `update-sanctum-authentication-system.md`
- `database-indexes-optimization.md`

---

## 文件結構規範

### 必要章節

```markdown
# {變更標題}

## 變更概要

簡要說明此次變更的目的和範圍

## 問題分析

描述變更前遇到的問題或需要改進的地方

## 解決方案

詳細說明採用的解決方案和實作方法

## 變更內容

列出具體的變更項目和檔案

## 測試結果

說明測試覆蓋率和測試結果

## 影響評估

分析變更對現有功能的影響

## 使用指南

提供新功能或變更後功能的使用方法

## 未來改進

列出可能的進一步改進方向
```

### 可選章節

- `技術細節` - 深入的技術實作說明
- `相關連結` - 相關文件或資源連結
- `注意事項` - 使用或維護時需要注意的事項
- `相容性說明` - 向下相容性或破壞性變更說明

---

## 內容格式規範

### 1. 標題規範

- 使用繁體中文
- 層級清晰，最多使用到 H4 (####)
- 具體明確，避免模糊表達

### 2. 程式碼區塊

````markdown
# PHP 程式碼

```php
class ExampleService
{
    public function example(): array
    {
        return ['status' => 'success'];
    }
}
```
````

# Bash 指令

```bash
./vendor/bin/sail test tests/Feature/ExampleTest.php
```

# 設定檔案

```env
APP_ENV=production
FEATURE_ENABLED=true
```

```

### 3. 檔案路徑格式

- 使用相對路徑，從專案根目錄開始
- 使用反引號標記：`app/Services/ExampleService.php`
- 目錄結構使用樹狀圖：

```

app/
├── Http/Controllers/
│ ├── API/V1/
│ └── Web/
├── Services/
└── Models/

````

### 4. 狀態標記

使用 emoji 標記重要狀態：

- ✅ **完成** - 已完成的項目
- ⚠️ **注意** - 需要注意的事項
- 🔧 **修復** - 問題修復
- 🆕 **新增** - 新功能
- 🔄 **變更** - 功能變更
- 📋 **測試** - 測試相關
- 🎯 **重要** - 重要資訊

### 5. 統計資料格式

```markdown
**測試統計:**
- **總測試數**: 19 個測試，66 個斷言
- **通過率**: 100% ✅
- **測試分類**:
  - EmailVerificationServiceTest: 8 個測試
  - Web EmailVerificationTest: 6 個測試
  - API EmailVerificationTest: 5 個測試
````

---

## 品質要求

### 1. 內容品質

- **準確性**: 所有技術細節必須準確
- **完整性**: 包含所有必要的資訊
- **清晰性**: 表達清楚，易於理解
- **可操作性**: 提供具體的操作步驟

### 2. 語言規範

- 使用台灣繁體中文
- 避免簡體中文或中國用語
- 技術術語保持一致性
- 語句通順，邏輯清晰

### 3. 程式碼品質

- 所有程式碼範例必須可執行
- 提供完整的上下文
- 包含必要的 import 和 namespace
- 遵循專案的程式碼風格

---

## 檔案管理

### 1. 版本控制

- 所有變更日誌檔案都要納入版本控制
- 檔案建立後不應刪除，只能更新
- 重大更新時可建立新版本檔案

### 2. 檔案關聯

- 在 README.md 中更新文件索引
- 相關的變更日誌之間建立交叉引用
- 主要功能文件中引用對應的變更日誌

### 3. 歸檔策略

- 重大變更的詳細記錄保持在 `docs/changes/`
- 過時的實作細節可移至 `docs/archive/`
- 保持 `docs/changes/` 目錄的整潔性

---

## 範例檔案

### 完整範例

參考現有檔案：

- `docs/changes/email-verification-refactor.md`
- `docs/changes/password-reset-architecture-refactor.md`

這些檔案展示了符合規範的變更日誌結構和內容。

---

## 自動化支援

### 1. 檔案模板

建議建立標準模板檔案，包含基本結構：

```markdown
# {變更標題}

## 變更概要

{簡要說明}

## 問題分析

{問題描述}

## 解決方案

{解決方案說明}

## 變更內容

{具體變更}

## 測試結果

{測試統計}

## 影響評估

{影響分析}

## 使用指南

{使用方法}

## 未來改進

{改進方向}
```

### 2. 檢查清單

每個變更日誌檔案完成前的檢查項目：

- [ ] 檔案命名符合規範
- [ ] 包含所有必要章節
- [ ] 程式碼範例可執行
- [ ] 測試結果已驗證
- [ ] 語言表達清晰
- [ ] 已更新相關索引

---

## 維護指南

### 1. 定期檢視

- 每月檢視變更日誌的完整性
- 更新過時的技術資訊
- 整理和歸檔舊的變更記錄

### 2. 持續改進

- 根據使用回饋調整格式規範
- 改進文件的可讀性和實用性
- 建立更好的檔案組織結構

這些規範確保專案的變更歷史清晰可追蹤，便於團隊協作和知識傳承。
