---
applyTo: "docs/tests/**/*.md"
description: "測試執行和文檔生成指令規範"
---

# 測試執行和文檔生成指令

供 AI 代理執行完整測試流程並生成標準化測試文檔的規範與格式。

---

## 指令

執行完整的測試流程，包括 PHPUnit 內部測試和 Python 外部 API 測試，並生成標準化的測試文檔。

---

## 目標

- 執行完整的測試套件驗證
- 生成詳細的測試報告和統計資料
- 建立按日期組織的測試記錄
- 提供雙重測試驗證 (內部 + 外部)
- 維護清晰的測試文檔結構

---

## 執行流程

### 階段 1: PHPUnit 測試執行

1. 確認 Laravel Sail 環境運行中
2. 執行 `./vendor/bin/sail artisan test`
3. 收集詳細的測試結果、統計和覆蓋率
4. 記錄所有測試方法、使用檔案和執行結果

### 階段 2: Python 外部 API 測試

1. 建立/更新 Python 測試腳本
2. 執行外部 HTTP API 測試
3. 驗證相同邏輯的測試場景
4. 生成 JSON 格式的測試資料

### 階段 3: 文檔整理和組織

1. 建立日期資料夾 (格式: YYYY-MM-DD-XX)
2. 生成綜合測試報告
3. 整理所有測試相關檔案
4. 更新主要 README 文檔

---

## 檔案結構規範

```
docs/tests/
├── README.md                                   # 主要說明文檔
├── YYYY-MM-DD-01/                            # 第一次測試執行
│   ├── README.md                              # 執行說明
│   ├── comprehensive-test-report.md          # 📊 綜合測試報告
│   ├── phpunit-test-report.md                # PHPUnit 詳細報告
│   ├── python-api-test-report.md             # Python 外部測試報告
│   ├── python-api-test-report-YYYY-MM-DD.json # 測試原始資料
│   └── python_api_tester.py                  # 測試腳本
└── YYYY-MM-DD-02/                            # 同日期第二次執行 (如有)
    └── ... (相同結構)
```

---

## 文檔內容規範

### 1. 綜合測試報告 (comprehensive-test-report.md)

#### 必要章節

- **執行摘要**: 測試總覽和統計
- **整體測試統計**: 表格形式的數據摘要
- **測試覆蓋範圍**: 功能和技術層面覆蓋情況
- **詳細測試分析**: PHPUnit 和 Python 測試詳情
- **程式碼品質分析**: 覆蓋率和品質評估
- **發現的問題與解決**: 問題記錄和解決方案
- **效能分析**: 執行時間和效能指標
- **建議與後續行動**: 改善建議

#### 統計表格格式

```markdown
| 測試類型        | 測試數量 | 通過數量 | 失敗數量 | 通過率 | 執行時間 |
| --------------- | -------- | -------- | -------- | ------ | -------- |
| PHPUnit 測試    | X        | X        | X        | X%     | Xs       |
| Python 外部測試 | X        | X        | X        | X%     | Xs       |
| **總計**        | **X**    | **X**    | **X**    | **X%** | **Xs**   |
```

### 2. PHPUnit 測試報告 (phpunit-test-report.md)

#### 必要內容

- **測試統計結果**: 總數、通過率、執行時間
- **測試分類統計**: Feature Tests vs Unit Tests
- **詳細測試結果**: 每個測試方法的結果表格
- **程式碼覆蓋率報告**: 類別覆蓋率分析
- **警告和建議**: 發現的問題和改善建議
- **測試執行環境**: Docker 容器狀態和配置

#### 測試方法表格格式

```markdown
| 測試方法         | 狀態   | 描述     | 執行時間 |
| ---------------- | ------ | -------- | -------- |
| `testMethodName` | ✓ PASS | 測試描述 | 0.XXs    |
```

### 3. Python 外部測試報告 (python-api-test-report.md)

#### 必要內容

- **測試統計結果**: 總數、通過率、執行時間
- **測試分類統計**: API 連線、功能、驗證、錯誤處理
- **詳細測試結果**: 每個測試的結果表格
- **與 PHPUnit 測試對比**: 相同點和差異點分析
- **技術實作細節**: 請求設定、測試資料清理、錯誤處理
- **發現的問題與修正**: 問題記錄和解決過程

### 4. 資料夾 README (README.md)

#### 必要內容

- **執行資訊**: 執行時間、版本、測試類型
- **檔案說明**: 表格形式的檔案列表和描述
- **測試結果摘要**: 重要統計數據
- **版本改進**: 與其他版本的比較 (如適用)
- **推薦閱讀順序**: 指導使用者如何閱讀報告

---

## 命名規範

### 日期資料夾

- 格式: `YYYY-MM-DD-XX`
- 例如: `2025-09-09-01`, `2025-09-09-02`
- 同日期多次執行使用遞增序號

### 檔案命名

- 綜合報告: `comprehensive-test-report.md`
- PHPUnit 報告: `phpunit-test-report.md`
- Python 報告: `python-api-test-report.md`
- 測試資料: `python-api-test-report-YYYY-MM-DD.json`
- 測試腳本: `python_api_tester.py`
- 說明文檔: `README.md`

---

## 品質要求

### 文檔品質

- ✅ **完整性**: 包含所有必要章節和內容
- ✅ **準確性**: 統計數據和分析準確無誤
- ✅ **可讀性**: 使用清晰的標題和格式
- ✅ **一致性**: 遵循統一的格式規範
- ✅ **實用性**: 提供有價值的分析和建議

### 測試覆蓋

- ✅ **功能完整**: 覆蓋所有 CRUD 操作
- ✅ **驗證規則**: 測試所有驗證場景
- ✅ **錯誤處理**: 測試各種錯誤情況
- ✅ **邊界條件**: 包含邊界值測試
- ✅ **效能驗證**: 記錄執行時間和效能

### 技術要求

- ✅ **雙重驗證**: PHPUnit + Python 外部測試
- ✅ **自動化**: 可重複執行的測試流程
- ✅ **標準化**: 統一的報告格式和結構
- ✅ **可追蹤**: 完整的執行記錄和歷史
- ✅ **可比較**: 支援版本間的比較分析

---

## 使用範例

### 執行命令

```bash
# PHPUnit 測試
cd laravel-todo-api
./vendor/bin/sail artisan test --coverage

# Python 外部測試
cd docs/tests/YYYY-MM-DD-XX
python3 python_api_tester.py
```

### 文檔結構範例

```
docs/tests/2025-09-09-02/
├── README.md                              # 執行說明
├── comprehensive-test-report.md           # 📊 綜合報告 (推薦)
├── phpunit-test-report.md                 # PHPUnit 詳細報告
├── python-api-test-report.md             # Python 外部測試報告
├── python-api-test-report-2025-09-09.json # 測試資料
└── python_api_tester.py                  # 測試腳本
```

---

## 維護指南

### 新測試執行

1. 建立新的日期資料夾 (如 `2025-09-10-01`)
2. 執行完整測試流程
3. 生成所有必要文檔
4. 更新主要 README.md

### 版本比較

1. 在各報告中提供版本比較表格
2. 記錄改進項目和解決問題
3. 標示推薦版本 (⭐️)

### 清理維護

1. 定期檢查檔案結構
2. 移除重複或過時檔案
3. 保持文檔的時效性和準確性

---

_此指令文件由 AI 代理生成，用於標準化測試執行和文檔生成流程_
